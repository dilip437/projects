<!DOCTYPE html>
<html>
  <head>
		<meta charset="utf-8">
      	<meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
      	<title>Spring Boot WebSocket Chat Application | CalliCoder</title>
		<script src="meeting/config.js"></script>
		<script src="meeting/common.js"></script>
        <script src="screenshare/js/socket.io.js"></script>
        <script src="screenshare/js/adapter-latest.js"></script>
        <script src="screenshare/js/IceServersHandler.js"></script>
        <script src="screenshare/js/getScreenId.js"></script>
        <script src="screenshare/js/CodecsHandler.js"></script>
        <script src="screenshare/js/BandwidthHandler.js"></script>
        <script src="screenshare/js/screen.js"></script>
      	<script src="meeting/jquery-1.12.4.js"></script>
  		<script>
  			$(document).ready(function () {
	  		  	$("#username-page").css({"display": "none"});
	  		  	$("#chat-page").css({"display": "none"});
	  		  	$("#p2p-chat-page").css({"display": "none"});
	  	  	});
	  	  
	  	  	function join_meeting_now() {
	  		  	$("#join-page-container").css({"display": "none"});
	  		  	$("#username-page").css({"display": "block"});
	  		  	$("#chat-page").css({"display": "block"});
	  		  	$("#p2p-chat-page").css({"display": "block"});
	  	  	}
	  	  
			var channel_hash_number;
	  	    var location_href;
	  	    var is_screen_share = false;
	  	    
		    var init = function(){
		    	var sa = location.href.split('#');
				if(sa.length > 0){
					is_screen_share = true;
				}
		    	
			    if(is_screen_share) {
			    	location_href = sa[0];
					channel_hash_number = (Math.random() * 100).toString().replace('.', '');
					location_href = location_href.split(meeting_path)[0];
					location_href = location_href + screenshare_view_path + '#' + channel_hash_number;
			    }else{
					location_href = location.href;
			    }
		    };
		    
		    function test_ajax() {
		    	/* $.ajax({
				    type: "GET",
				    url: "http://localhost:8080/team/",
				    success: function (data) {

				    	if(data == undefined || data == null || data.length < 0) {
				    		alert("result == undefined");
				    		return false;
				    	}
						$.each(data, function (index, team) {
							alert("teamname =" + team.teamname);
						});
				    },
				    error: function (e) {
				    	alert("Error Find User");
						alert("error = " + e.responseText);
				    }
				}); */
				
		    	$.ajax({
				    type: "GET",
				    url: "http://localhost:8080/org/",
				    success: function (data) {
				    	if(data == undefined || data == null || data.length < 0) {
				    		alert("result == undefined");
				    		return false;
				    	}
				    	var org_string = "";
				    	$.each(data, function (index, org) {
				    		org_string = org_string + (org_string.length > 0 ? "," : "") + org.orgname;
						});
				    	
				    	alert("org_string =" + org_string);
				    },
				    error: function (e) {
						alert("Error Find All Users :: error =" + e.responseText);
				    }
				});
		    }
  		</script>
  		<script src="screenshare/screenshare_main.js"></script>
      	<link rel="stylesheet" href="meeting/css/main.css"/>
	</head>
	<style>
		.room-section {
			position: relative;
		}
		.chat-user-name {
			position: relative; text-align: left; font-size: 15px; color: #008800; padding-left: 15px;
		}
		.chat-room-name {
			position: relative; text-align: left; font-size: 15px; color: #0000FF;
		}
 	</style>
  	<script src="meeting/meeting.js"></script>
  	<script src="chat/chat.js"></script>
  	<script src="chat/p2pchat.js"></script>
  	<script src="meeting/send-alert.js"></script>
	<body>
	    <noscript>
	      <h2>Sorry! Your browser doesn't support Javascript</h2>
	    </noscript>
		<div id="login-section">Welcome: <span id="login_name"></span></div>
	    <div id="username-page">
			<div id="alert-recv-section" style="text-align: left; display: none;">
				<a href="#" id="alert-recv-text">Alert Recv</a>
				<a href="#" style="float: right; text-decoration: none; color: #FF4743;" onclick="$('#alert-recv-section').css({'display': 'none'});">Close</a>
			</div>
			<div id="left-section">
				<div id="left-menu-section">
					<div id="new-room-section">
					  <a href="#" onclick="newMeeting();">New Meeting</a>
					</div>
					<div id="screen-sharing-section">
					  <a href="#" id ="share-screen">Share Screen</a>
					</div>
				</div>
				<div id="rooms-header">Joined Meeting</div>
				<div id="rooms-section"></div>
				<div id='meeting-section' class='meeting-section'>
					<div id='inbox-section' class='inbox-section'></div>
					<a href="#" id="send-alert-link" 
						style="position: fixed; top: 510px; left: 5px; text-decoration: none; color: #008800;">Send Alert</a>
					<a href="#" id="test-ajax-link" 
						style="position: fixed; top: 510px; left: 135px; text-decoration: none; color: #880000;" onclick="test_ajax();">Test</a>					 
				</div>
	        </div>
			<div id="users-video-section" style="position: fixed; top: 535px; height: 100px; width:900px; text-align: left; color: #FF4743; border: 1px solid #0000FF; overflow-y: auto;"></div>
	        <div class="username-page-container">
	            <form id="usernameForm" name="usernameForm">
	                <div class="form-group">
	                    <input type="hidden" id="name"/>
	                    <input type="hidden" id="user-name"/>
	                </div>
	                <div class="form-group">
	                    <input type="text" id="route_id" placeholder="Roomname" autocomplete="off" class="form-control"/>
	                </div>
	                <div class="form-group">
	                    <button type="submit" class="accent username-submit">Start</button>
	                </div>
	            </form>
	        </div>
	    </div>
	    <div id="chat-page">
	        <div class="chat-container">
	            <div class="chat-header">Chat</div>
	            <div class="connecting">Connecting...</div>
	            <ul id="messageArea"></ul>
	            <form id="messageForm" name="messageForm" nameForm="messageForm">
	                <div class="form-group">
	                    <div class="input-group clearfix">
	                        <input type="text" id="message" placeholder="Type a message..." autocomplete="off" class="form-control"/>
	                        <button type="submit" class="primary">Send</button>
	                    </div>
	                </div>
	            </form>
	        </div>
	    </div>
	    <div id="p2p-chat-page">
	        <div id="chat-holder" class="chat-holder"></div>
	    </div>
	    
		<div id="join-page-container" style="position: fixed; top: 100px; width:100%; height: 100%;">
			<div style="margin-left:500px; margin-top:100px; font-size: 25px; text-align: center; width: 250px;">
				<a href="#" onclick="join_meeting_now();">Join Meeting Now</a>
			</div>
			<div class="input-group clearfix" style="margin-top: 125px;">
                <a href="http://localhost:8080/home.html" style="margin-left: calc(50% - 50px);"> 
                	<button type="button" class="primary">Back</button>
                </a>
            </div>
		</div>
    
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/sockjs-client/1.1.4/sockjs.min.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/stomp.js/2.3.3/stomp.min.js"></script>
	    <script src="meeting/main.js"></script>
		<script type="text/javascript">
	    	var meeting_number;
	    	function page_local_callback_document_ready() {
				var sa = location.href.split('#');
				if(sa.length > 0){
					meeting_number = sa[1];
				}
				populateRooms();
				populateMeetings();
	    	}
	</script>
	</body>
</html>
